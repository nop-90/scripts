import unittest
import ../rsa_convert

class TestKeyConversion(unittest.TestCase):

    def test_pkcs1_privkey_reading():
        # Without password
        key = rsa_convert.pkcs1_privkey_reading('example_keys/pkcs1')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 20383296292884926055106316940864485091568331868443478631510507913459922520347413540839650544898270200345388258028998138091729353792706679431837741927105066234040897840629017464106857724422575457663500863225440337799459214794489955220146021793470283034111396127037214320386598516982648506363287298684866935268518740005654065767513710451575139636747118069263948321104384031022313961378515744923153357871051225624890275363737505362107499261993197172367773007966308023979202463272739226063978739624096386938566077287752598511050886080107301340670536628418642682686428182377741477409081676859763865200224021732195286362511)
        self.assertEqual(key['d'], 12809034202453160728344272043159786899173751921357038374660554464011679647801820029387066360088047361506087706466061298490467700788849533633227116949599387335134967066976905492191843211050541642864543991196980863816362181700356658311892423540019838205545626716143562179696990605664180479516389583121558201658405288961116849537235530080450925873482232237351508608670379992745030854670065466530265737985396371806889973652112739445888921876867209858030139007026067046643974971639556059555135476403833810284930114584086797730275960871385316329869829271112965344686116079467286029054816449936795503603524830078109380843777)
        self.assertEqual(key['p'], 148361831195006549328279346032929534645535680423776054476105266995356875277188525064947929910975757944644274726884135395192652352079441251616587229210373391863206819587659568589390060239451229520130170952428114598125262823960040139722888569961509725680208658546525131404514101814728357152417852734559284783053)
        self.assertEqual(key['q'], 137389085377984817403454248449350521429353995791759783954650811799609399560144224520355154301642046470355067186034784956589908267619507366319337971270810408244924652126668976747488016091180306392710748033622452472339578976136104530622303241515349502395351480415143976002491388188300685794887394987606512157387)
        # With password
        key = rsa_convert.pkcs1_privkey_reading('example_keys/pkcs1_pass', 'password')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 24401974064328165493354954437093364625794155902357270459835615583756397632471154528289073105585308324390381964470044751747409798029386548303961879523085027401589572016166273446204654029172156256961372413995557685119388606317721314054531238256704455842810138001313143469954504281944127762974120893109657925333052443364723655071464843209113864599413718054408967536360602538188418842188336529305918794233728086856727274765037272659713258703156441681394189640307195173831597551270911869731553622687424551413876285005430686458955514056588233802287477212643445348537219777623181712092300982418081610326739344940726197499199)
        self.assertEqual(key['d'],5441732928729666275315968980852335688328449402825144693386903913157449248494223468131663082504986208721263292654984269142444637352937797022482000537557222263366214428739034231293483354995667541930366935174711621954313814811991653644612570717636382839352887176544419058140975022973487148570529271294042305548590726163706787106492835751863520030889773631192511080677222703757017696787521596642843335219321793189886973174100250297001307780237080860897007883273232346642854352395376730746808261078234510206871436286101429162427373556230228007149962645589951107767775167658662978661590373162730669371720804646572776309753)
        self.assertEqual(key['p'], 163681390251067633422510756960798082335908939052531651347239222393632184443600753158338162804433786194403127830409485141230501139652636556106168485887875866513091930229875321573644910578717568991820640692271565070887643060295054155941192733028310310467601536373306450651615117475889572479678199095512995626373)
        self.assertEqual(key['q'], 149082152997958180552015882198943201003700701571721639762378414246810688236435887048571143898080317748494344614339857055631255134944272564179077901181014257579693052246250040942474363406397362481738619346875894359809042343904506850958867312045608815026396813754439364585082150541516028362663857160817714974963)

    def test_pkcs8_privkey_reading():
        # Without password
        key = rsa_convert.pkcs1_privkey_reading('example_keys/pkcs8')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 24401974064328165493354954437093364625794155902357270459835615583756397632471154528289073105585308324390381964470044751747409798029386548303961879523085027401589572016166273446204654029172156256961372413995557685119388606317721314054531238256704455842810138001313143469954504281944127762974120893109657925333052443364723655071464843209113864599413718054408967536360602538188418842188336529305918794233728086856727274765037272659713258703156441681394189640307195173831597551270911869731553622687424551413876285005430686458955514056588233802287477212643445348537219777623181712092300982418081610326739344940726197499199)
        self.assertEqual(key['d'],5441732928729666275315968980852335688328449402825144693386903913157449248494223468131663082504986208721263292654984269142444637352937797022482000537557222263366214428739034231293483354995667541930366935174711621954313814811991653644612570717636382839352887176544419058140975022973487148570529271294042305548590726163706787106492835751863520030889773631192511080677222703757017696787521596642843335219321793189886973174100250297001307780237080860897007883273232346642854352395376730746808261078234510206871436286101429162427373556230228007149962645589951107767775167658662978661590373162730669371720804646572776309753)
        self.assertEqual(key['p'], 163681390251067633422510756960798082335908939052531651347239222393632184443600753158338162804433786194403127830409485141230501139652636556106168485887875866513091930229875321573644910578717568991820640692271565070887643060295054155941192733028310310467601536373306450651615117475889572479678199095512995626373)
        self.assertEqual(key['q'], 149082152997958180552015882198943201003700701571721639762378414246810688236435887048571143898080317748494344614339857055631255134944272564179077901181014257579693052246250040942474363406397362481738619346875894359809042343904506850958867312045608815026396813754439364585082150541516028362663857160817714974963)
        # With password
        key = rsa_convert.pkcs1_privkey_reading('example_keys/pkcs8', 'password')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 24401974064328165493354954437093364625794155902357270459835615583756397632471154528289073105585308324390381964470044751747409798029386548303961879523085027401589572016166273446204654029172156256961372413995557685119388606317721314054531238256704455842810138001313143469954504281944127762974120893109657925333052443364723655071464843209113864599413718054408967536360602538188418842188336529305918794233728086856727274765037272659713258703156441681394189640307195173831597551270911869731553622687424551413876285005430686458955514056588233802287477212643445348537219777623181712092300982418081610326739344940726197499199)
        self.assertEqual(key['d'],5441732928729666275315968980852335688328449402825144693386903913157449248494223468131663082504986208721263292654984269142444637352937797022482000537557222263366214428739034231293483354995667541930366935174711621954313814811991653644612570717636382839352887176544419058140975022973487148570529271294042305548590726163706787106492835751863520030889773631192511080677222703757017696787521596642843335219321793189886973174100250297001307780237080860897007883273232346642854352395376730746808261078234510206871436286101429162427373556230228007149962645589951107767775167658662978661590373162730669371720804646572776309753)
        self.assertEqual(key['p'], 163681390251067633422510756960798082335908939052531651347239222393632184443600753158338162804433786194403127830409485141230501139652636556106168485887875866513091930229875321573644910578717568991820640692271565070887643060295054155941192733028310310467601536373306450651615117475889572479678199095512995626373)
        self.assertEqual(key['q'], 149082152997958180552015882198943201003700701571721639762378414246810688236435887048571143898080317748494344614339857055631255134944272564179077901181014257579693052246250040942474363406397362481738619346875894359809042343904506850958867312045608815026396813754439364585082150541516028362663857160817714974963)

    def test_ssh_privkey_reading():
        # Without password
        key = rsa_convert.pkcs1_privkey_reading('example_keys/id_rsa')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 24439271961847346300962496456126609829668254038979591249424386301451063758731305077212015048868619963709093487381967876699777364226491874574752038012992586890247142308078437961349141486732490045134940991330484827634543977822373096412622382343387125013057109723568323480847926532271134374572075895722995937468250450606331900842036133078586923552840670158425714382955024254078494545961132798833665035451747615543775287521132047953605580121790221408575819340122717658107966866047460422004273062331262281093554977285929834144346757504222512774924159339512804004503660017862716089516481046747531559541099156378550436305459)
        self.assertEqual(key['d'], 19768972099934592206737031365925202052278913459090667423069945084438183667876507561503281410282316098327817462602503365236206988567359106258011959521839205468859907459574930674962266164703137079248952908637914341019425361189823534188662135208660476651619643221012977900883335051273168539896386155301023599386419334806439977000740901373521070875799227058790471751414009624047792425662317244122197394044796989775571820146735225657924882519310391781021986328547432030525816317491857011403603240474637622783935727593348502880179013942106408696707801404894143047807789789482587002551386769415018896199542558573744854759057)
        self.assertEqual(key['p'], 164610659575987440783322442946905528244774315659540071435586096745381157444892917412299637108268304190165277974544770332005875515394891092907132378053542054399583914959251106868497124031217066117542415917733070372502201541850166578837952400607056918177826376165116120121788515095381010202743239412396239110857)
        self.assertEqual(key['q'], 148467128585714153944481483989471517375894262928188399150397568586576271193483477746107431174787475031921925926407576719114973961684690545181487256072287048362139124112489530246070666555636751308783848047213592978675106266565134629939428211564388307834159534717796819484100135312533976040685144490581855573787)
        # With password
        key = rsa_convert.pkcs1_privkey_reading('example_keys/id_rsa_pass', 'password')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 30545391900372115931112251537139228584566864386625445767079390971031855824291513354740218648034953413366120501403274526793238511117857080276284251345006041552446044558355934996162517195297542322052143339343493230201868848375367253545648946749355266536201504015777240602075790761655152231847333892901801492192449359865348939348053882950770776190185034372661409640794218499958185514024939591491483633835232170142573009893930368866003952448664508637584320196901170123864680352789480964107911266242021877740826257467264569690158878549300267118914197343452376847685942867245153626384264815035560464203282023821030808466789)
        self.assertEqual(key['d'], 2541526496982302335663138496300108541307095404126959668094113538383458348869518322831353468845607839282931093796665334003746427226233649064598288334594472505386091535723559417337903875153844367031605621701330066745362021914199271153461765210861563215006893837039127408992161481656248304320666367364901102231159802203379898912752760483417859538880818585139935014758099839093817715153051268264619641095055137197457745280779507176087697645424265295053065976530889146651766141564022294090928221663637726147851465593398950166247341942540508692528038512084023047619632400941498457235726498219512536381653493189760304761629)
        self.assertEqual(key['p'], 178077728274359110600310686143538267625576139629203984760526171596217657986794993313506311475178710273050439966506453896264507232220255019431182285358974372090080619219061423256096658315859470636733286163762943364362346574118276358678066634023941501325051226460928355512981254910095854087906571837403622447083)
        self.assertEqual(key['q'], 171528422989042910279968046443438069335139946893214080350290686203242090773974239062191989800613055228079648147404373103012975275463128615055249610807759294023490689066233021901298770191002741130914628997507311811702996510616188782937385070981595355191287998660076290152815283248113959676273126075444333798383)
        # Without password / New Format
        key = rsa_convert.pkcs1_privkey_reading('example_keys/id_rsa_new')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 22182303890757421953475898173337734465816550670773928881817984593120255820041770749818646346226857040176647372775771821351623895868309244595956494762052646135258457315759398199569590799802338310684083733649073597328833634207830967045857841147918832644600979853288859972081036755425956339380060209977609360948974115157008909700772126108141714916346149713431606761617199316207095963697033927171401649657749463862891175331629655417828397350228525631324024974633554762311047545628926208641690257054287593310080163580563204010046446175268506418248807852570854319520339402321639619220544890670293042874620623134857365506191)
        self.assertEqual(key['d'], 5322778140379498873008559663608483943565178080299537751124855054570840029692797760221676799987237038830247899419744383517335816201916950432824386783466437479943764587143633307695368798048302062557301994222581616363172524399230202599495863556344836690251232268380008421516797900664183429102504338955214379820237027512843398608225765322989546852815340480437356150078319006514267194742485425576865669727282770627045317847303726166253738738256294719249295285494477636309636379011075165724400833050779323040819588082169444462458766197680362764617602244765587039715556836629048957161616100060946423248674565525966465305489)
        self.assertEqual(key['p'], 158177399506719208543223284528407607080351224740701788592043844987920345694733515595356323135363165106472805317015496432460677993624233571902101768864269755903171120461319705576554482516265445826647851873911368982138327478483199954018813792662713795795884034533576829857759194352989666899831681150118265096203)
        self.assertEqual(key['q'], 140236873029481946680639948580499723550488233926628614912298245610277669265287354471184243162540760247918497462233114742853966610254121194901952130769184481746510574267896905196634096066133269566212844318813930809660620267599376507168834304394832764482534446882684339311861472122069639458930808900975636291597)
        # With password / New Format
        key = rsa_convert.pkcs1_privkey_reading('example_keys/id_rsa_pass_new', 'password')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 26147456126215347485677115793520275916750139287291734554455566136138449386715956838204371704481790511302372435939196373433353440153919457604825923718633916815857482544916143611760435167453015660245400746621826538309644468190956574460781667772101764487541695408080109243755139491045271619108616529202856864010404848383620090425287798529393837174606254493331962325054542697653217803270907975805879241145174686448838592749054290965007219205198563147879088125045663807977747832517185148390162719416400932577745543115111744708996913625833776575337405913927197234650808657978114388122001906748193371632612706051481126593109)
        self.assertEqual(key['d'], 14881272655930333183823958099737747706163898946804010057626045765168195426631040085877975192722680383311216404292172139900981887549034009020895099390898674997553568845733360400614194597110487680417065206650403711680599188535552272316595135972528857189386418313715610947752001890176504663337233744644053865308329375261795607045889967532575141075661179522163984752907661550233464774269040344040377104706222783117822001556611773344063472380813674118068505404532872671107015588713278263630253598248202649982239687840624189948469189590512649643266297472541512505459137800370198505766538696626755103043378434173174403230305)
        self.assertEqual(key['p'], 176377447302678488365323033325696138463585359491012971717842146812018458887999012944396185397636246011402888326639962691249072735134457985846672761988538921118993093453074538732508824228319720589895750354717266021166504643557219851722551847681583868021053918155031705537790049107106921146225651578623369659257)
        self.assertEqual(key['q'], 148247162696170108281203553593087531340751593315437442794610547955047412393576888881639244623065330241647599754308861916754264612068293996160524998788086139269262242281298267140805452377484223546174615892087351508741820060497755155992576325342288744782640500222511635842432009365592491180403182508265385435837)

    def test_pkcs8_pubkey_reading():
        key = rsa_convert.pkcs1_privkey_reading('example_keys/pkcs8.pub')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 24439271961847346300962496456126609829668254038979591249424386301451063758731305077212015048868619963709093487381967876699777364226491874574752038012992586890247142308078437961349141486732490045134940991330484827634543977822373096412622382343387125013057109723568323480847926532271134374572075895722995937468250450606331900842036133078586923552840670158425714382955024254078494545961132798833665035451747615543775287521132047953605580121790221408575819340122717658107966866047460422004273062331262281093554977285929834144346757504222512774924159339512804004503660017862716089516481046747531559541099156378550436305459)

    def test_ssh_pubkey_reading():
        key = rsa_convert.pkcs1_privkey_reading('example_keys/id_rsa.pub')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 24439271961847346300962496456126609829668254038979591249424386301451063758731305077212015048868619963709093487381967876699777364226491874574752038012992586890247142308078437961349141486732490045134940991330484827634543977822373096412622382343387125013057109723568323480847926532271134374572075895722995937468250450606331900842036133078586923552840670158425714382955024254078494545961132798833665035451747615543775287521132047953605580121790221408575819340122717658107966866047460422004273062331262281093554977285929834144346757504222512774924159339512804004503660017862716089516481046747531559541099156378550436305459)
        # New Format
        key = rsa_convert.pkcs1_privkey_reading('example_keys/id_rsa_new.pub')
        self.assertEqual(key['e'], 65537)
        self.assertEqual(key['n'], 22182303890757421953475898173337734465816550670773928881817984593120255820041770749818646346226857040176647372775771821351623895868309244595956494762052646135258457315759398199569590799802338310684083733649073597328833634207830967045857841147918832644600979853288859972081036755425956339380060209977609360948974115157008909700772126108141714916346149713431606761617199316207095963697033927171401649657749463862891175331629655417828397350228525631324024974633554762311047545628926208641690257054287593310080163580563204010046446175268506418248807852570854319520339402321639619220544890670293042874620623134857365506191)

    def test_generate_privkey():

    def test_generate_pubkey():

    def test_priv_ssh_to_pkcs8():

    def test_priv_pkcs1_to_pkcs8():

    def test_priv_pkcs1_to_ssh():

    def test_priv_pkcs8_to_pkcs1():

    def test_priv_pkcs8_to_ssh():

    def test_pub_pkcs8_to_ssh():

    def test_pub_ssh_to_pkcs8():

if __name__ == '__main__':
    unittest.main()
